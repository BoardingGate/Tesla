<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual de Usuario - BoardingGate Lanzador</title>
    <style>
        body {
            font-family: sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            color: #2F4F4F; /* Dark Slate Gray */
            margin-top: 1.5em;
            margin-bottom: 0.8em;
        }
        h1 {
            text-align: center;
            border-bottom: 2px solid #ABAB99;
            padding-bottom: 10px;
            margin-top: 0;
        }
        h2 {
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }
        p {
            margin-bottom: 1em;
        }
        ul, ol {
            margin-left: 20px;
            margin-bottom: 1em;
        }
        li {
            margin-bottom: 0.5em;
        }
        code {
            background-color: #e8e8e8;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }
        strong {
            color: #4682B4; /* Steel Blue */
        }
        .image-placeholder {
            display: block;
            text-align: center;
            font-style: italic;
            color: #777;
            background-color: #f0f0f0;
            padding: 15px;
            margin: 15px 0;
            border: 1px dashed #ccc;
            border-radius: 4px;
        }
        .warning {
            color: #dc3545; /* Red */
            font-weight: bold;
        }
        .note {
             font-size: 0.9em;
             color: #555;
        }
         a {
            color: #007bff;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Manual de Usuario: BoardingGate Lanzador</h1>

        <h2>1. Introducción</h2>
        <p>Bienvenido a BoardingGate Lanzador, tu página de inicio personalizada y centro de herramientas rápidas, diseñada especialmente para una navegación eficiente (potencialmente en pantallas de coche como Tesla, pero útil en cualquier navegador). Esta aplicación te permite:</p>
        <ul>
            <li>Acceder rápidamente a tus sitios web favoritos (marcadores).</li>
            <li>Organizar marcadores en secciones que puedes ocultar/mostrar.</li>
            <li>Filtrar marcadores por nombre.</li>
            <li>Crear y gestionar recordatorios con notificaciones.</li>
            <li>Personalizar completamente la disposición, contenido y apariencia de los marcadores y secciones.</li>
            <li>Configurar ajustes, realizar copias de seguridad y restaurar tu configuración.</li>
            <li>Proteger el acceso con una clave (PIN).</li>
        </ul>

        <h2>2. Interfaz Principal</h2>
        <p>Al cargar la aplicación, verás varios elementos clave:</p>
        <div class="image-placeholder">[Imagen: Captura de pantalla principal de la aplicación, señalando las áreas descritas a continuación]</div>

        <h3>A. Cabecera (Inferior Central):</h3>
        <ul>
            <li><strong>Logo:</strong> Logotipo de BoardingGate/Tesla.</li>
            <li><strong>Título:</strong> "BoardingGate Lanzador" y el número de versión actual.</li>
        </ul>

        <h3>B. Rejilla de Marcadores (Centro):</h3>
        <ul>
            <li>El área principal que muestra tus marcadores (iconos + nombres).</li>
            <li>Cada marcador es un enlace directo a una URL.</li>
            <li>Los espacios vacíos muestran un símbolo <code>+</code> y pueden ser usados para añadir nuevos marcadores en el modo de personalización.</li>
        </ul>

        <h3>C. Botones Laterales (Izquierda, Fijos):</h3>
        <ul>
            <li><strong>Scroll (↑↓):</strong> Te lleva al inicio o al final de la página.</li>
            <li><strong>On/Off General:</strong> Oculta/Muestra <strong>todos</strong> los marcadores de las secciones configurables.</li>
            <li><strong>Toggles de Sección (+/-):</strong> Botones con etiquetas (ej. <code>PdR,s</code>, <code>iAs</code>, <code>Útil</code>, <code>Varios</code>). Permiten ocultar/mostrar grupos específicos de marcadores. El signo <code>-</code> indica visible, <code>+</code> indica oculto. El color del botón indica la sección.</li>
            <li><strong>Tiempo (Nube):</strong> Abre una web de previsión meteorológica (Ventusky).</li>
            <li><strong>Recordatorios (Campana):</strong> Accede a la gestión de recordatorios. Un número sobre la campana indica recordatorios activos. Una pulsación larga muestra la lista completa.</li>
            <li><strong>Zoom (+/- Lupa):</strong> Cambia la vista de la rejilla entre 6 columnas (normal) y 4 columnas (zoom).</li>
            <li><strong>Modo Claro/Oscuro (Sol/Luna):</strong> Cambia el tema visual de la aplicación.</li>
        </ul>

        <h3>D. Botones Superiores (Cerca de la Cabecera, Fijos):</h3>
        <ul>
            <li><strong>Configuración (Engranaje):</strong> Abre el panel de configuración avanzada.</li>
            <li><strong>Personalización (P con Lápiz):</strong> Entra en los modos de edición de la rejilla.</li>
            <li><strong>Home (Casa):</strong> Vuelve a la página anterior en el historial del navegador.</li>
            <li><strong>Recargar (Flecha Circular):</strong> Recarga la página actual.</li>
            <li><strong>Clave (Candado Abierto/Cerrado):</strong> Activa/Desactiva la solicitud de PIN al inicio (si un PIN está configurado).</li>
        </ul>

        <h3>E. Filtro de Rejilla (Arriba Derecha):</h3>
        <ul>
            <li><strong>Campo de Texto:</strong> Escribe aquí para filtrar los marcadores por nombre en tiempo real.</li>
            <li><strong>Botón Limpiar (<code>X</code>):</strong> Aparece cuando hay texto en el filtro para borrarlo rápidamente.</li>
        </ul>

        <h3>F. Barra de Avisos (Entre Rejilla y Footer):</h3>
        <ul>
            <li>Muestra mensajes o avisos importantes de forma rotativa.</li>
            <li><strong>Icono Izquierda (Imagen):</strong> Permite ocultar/mostrar esta barra de avisos y el footer.</li>
        </ul>

        <h3>G. Footer (Inferior):</h3>
        <ul>
            <li>Contiene enlaces (Twitter @BoardingGate, Referidos), contador de visitas (Statcounter) y un mensaje final. Puede ocultarse con el icono de la barra de avisos.</li>
        </ul>

        <h3>H. ID de Usuario (Sobre la Rejilla, Derecha):</h3>
        <ul>
            <li>Muestra tu "ID Usuario (Apodo)" si lo has configurado.</li>
        </ul>

        <h3>I. Globo Recordatorios (Esquina Superior Izquierda):</h3>
        <ul>
            <li>Muestra el número de recordatorios <em>no cíclicos</em> pendientes. Al hacer clic, abre la lista completa de recordatorios.</li>
        </ul>

        <h2>3. Uso Básico</h2>
        <ul>
            <li><strong>Abrir un Marcador:</strong> Simplemente haz clic (o toca) sobre el icono/nombre del marcador en la rejilla. Se abrirá la URL asociada (normalmente en una nueva pestaña).</li>
            <li><strong>Ocultar/Mostrar Secciones:</strong>
                <ul>
                    <li>Haz clic en un botón lateral con etiqueta (ej., <code>PdR,s</code>) para ocultar (<code>+</code>) o mostrar (<code>-</code>) todos los marcadores asignados a esa sección.</li>
                    <li>Haz clic en el botón general <strong>On/Off</strong> para ocultar/mostrar <em>todos</em> los marcadores que pertenezcan a <em>alguna</em> sección configurable a la vez.</li>
                </ul>
            </li>
            <li><strong>Navegar:</strong> Usa el botón de <strong>Scroll (↑↓)</strong> para ir rápidamente arriba o abajo.</li>
            <li><strong>Cambiar Tema:</strong> Usa el botón <strong>Sol/Luna</strong> para alternar entre modo claro y oscuro.</li>
            <li><strong>Zoom:</strong> Usa el botón de <strong>Lupa (+/-)</strong> para cambiar el tamaño de la rejilla.</li>
        </ul>

        <h2>4. Filtrar Marcadores</h2>
        <ol>
            <li>Localiza el campo de texto <code>Filtrar grid...</code> en la esquina superior derecha, sobre la rejilla.</li>
            <li>Empieza a escribir el nombre (o parte del nombre) del marcador que buscas.</li>
            <li>La rejilla se actualizará automáticamente, mostrando solo los marcadores que coincidan con tu texto. El filtro no distingue mayúsculas/minúsculas ni acentos.</li>
            <li>Para quitar el filtro, borra el texto del campo o haz clic en el botón <code>X</code> que aparece a su derecha.</li>
            <li><span class="note">El filtro se aplica <em>después</em> de la visibilidad por secciones. Si una sección está oculta, sus marcadores no aparecerán aunque coincidan con el filtro.</span></li>
        </ol>

        <h2>5. Recordatorios</h2>
        <p>El sistema de recordatorios es potente y permite crear avisos basados en texto, incluyendo fechas, horas y repeticiones interpretadas del lenguaje natural.</p>

        <h3>Acceder:</h3>
        <ul>
            <li><strong>Crear/Modificar:</strong> Haz clic corto en el botón de <strong>Recordatorios (Campana)</strong>.</li>
            <li><strong>Ver Lista:</strong> Haz una pulsación larga (mantén presionado 2 segundos) en el botón de <strong>Recordatorios (Campana)</strong> o haz clic en el <strong>Globo de la esquina superior izquierda</strong> (si está visible).</li>
        </ul>

        <h3>Crear/Modificar un Recordatorio:</h3>
        <div class="image-placeholder">[Imagen: Modal de creación/edición de recordatorios]</div>
        <ol>
            <li><strong>Texto Principal:</strong> Escribe el texto del recordatorio. Puedes incluir información de tiempo, fecha o repetición en lenguaje natural (ver Ayuda). Ej: <code>LLAMAR A JUAN MAÑANA A LAS 10</code>, <code>RECOGER PAQUETE EL DIA 25</code>, <code>PAGAR FACTURA CADA LUNES A LAS 9:00</code>, <code>ALARMA EN 15 MINUTOS</code>.</li>
            <li><strong>Interpretación:</strong> La aplicación intentará interpretar la fecha, hora, días de repetición o intervalo y rellenará los campos inferiores. Un mensaje ("Parseando...", "Parseado OK", "Error parse") te indicará el estado.</li>
            <li><strong>Campos Manuales:</strong> Puedes ajustar o introducir manualmente la Hora (HH:MM), Fecha (DD/MM/AAAA), Intervalo (días) y marcar los Días de Repetición (Lun-Dom).</li>
            <li><strong>Voz (Micrófono):</strong> Si tu navegador lo soporta, pulsa el icono del micrófono para dictar el texto.</li>
            <li><strong>Botones:</strong>
                <ul>
                    <li><strong>Limpiar:</strong> Borra todos los campos.</li>
                    <li><strong>Aceptar (con cuenta atrás):</strong> Guarda el recordatorio. El número indica segundos restantes para auto-guardado.</li>
                    <li><strong>Cancelar:</strong> Cierra el modal sin guardar.</li>
                    <li><strong>Ver Recordatorios:</strong> Abre la lista completa de recordatorios.</li>
                    <li><strong>Ayuda:</strong> Muestra ejemplos de texto interpretables.</li>
                </ul>
            </li>
        </ol>

        <h3>Notificaciones:</h3>
        <div class="image-placeholder">[Imagen: Notificación de recordatorio (amarilla)]</div>
        <ul>
            <li>Cuando un recordatorio vence, aparecerá una notificación amarilla en el centro-izquierda.</li>
            <li><strong>Contenido:</strong> Muestra el texto, hora/fecha y detalles de repetición.</li>
            <li><strong>Botones:</strong>
                <ul>
                    <li><strong>Modificar:</strong> Abre el modal para editar este recordatorio.</li>
                    <li><strong>Posponer:</strong> Abre opciones para retrasar el recordatorio (15 min, 1h, 3h, 1 día, 3 días).</li>
                    <li><strong>Visto / Próximo:</strong> Marca el recordatorio como visto. Si es simple, lo elimina. Si es cíclico (semanal/intervalo), calcula y actualiza a la siguiente ocurrencia.</li>
                    <li><strong>Anular Ciclo (Solo cíclicos):</strong> Elimina permanentemente este recordatorio cíclico.</li>
                </ul>
            </li>
        </ul>

        <h3>Lista Completa de Recordatorios:</h3>
        <div class="image-placeholder">[Imagen: Modal de la tabla de recordatorios]</div>
        <ul>
            <li>Muestra todos tus recordatorios ordenados por próxima ocurrencia.</li>
            <li><strong>Acciones (Botones por Fila):</strong>
                <ul>
                    <li><strong>Visto/Prox:</strong> Igual que en la notificación.</li>
                    <li><strong>Posponer:</strong> Igual que en la notificación.</li>
                    <li><strong>Anular Ciclo:</strong> Igual que en la notificación.</li>
                </ul>
            </li>
            <li><strong>Modificar:</strong> Haz clic en cualquier parte de la fila (excepto los botones de acción) para abrir el modal de edición.</li>
            <li><strong>Salir:</strong> El botón <strong>SALIR</strong> (arriba y abajo) cierra la tabla. Se cierra automáticamente tras 60 segundos de inactividad (el contador se reinicia con cualquier interacción).</li>
        </ul>

        <h2>6. Personalización</h2>
        <p>Esta función te permite adaptar la rejilla a tus necesidades. Se accede pulsando el botón de <strong>Personalización (P con lápiz)</strong>.</p>

        <h3>1. Elegir Modo:</h3>
        <p>Al pulsar <strong>Personalización</strong>, aparecerá un menú:</p>
        <ul>
            <li><strong>URLs / Etiquetas / Reordenar:</strong> Entra en modo edición (botón se vuelve amarillo).</li>
            <li><strong>Asignar Botones Ocultación:</strong> Entra en modo asignación (botón se vuelve cian).</li>
            <li><strong>Ver Ayuda:</strong> Muestra una explicación detallada de ambos modos.</li>
            <li><strong>Cancelar:</strong> Cierra el menú.</li>
        </ul>

        <h3>2. Modo Edición (Botón Amarillo):</h3>
        <div class="image-placeholder">[Imagen: Rejilla en modo edición, con un marcador resaltado en amarillo y el modal de edición abierto]</div>
        <ul>
            <li><strong>Editar Marcador:</strong> Haz clic en un marcador existente o en un espacio vacío (<code>+</code>). Se abrirá un modal de edición y el elemento seleccionado se resaltará en amarillo.
                <ul>
                    <li><strong>Campos:</strong> Nombre (obligatorio), URL (obligatoria), URL Favicon (opcional, si se deja vacío intenta buscarlo automáticamente). Hay botones <code>🔍</code> y <code>🖼️</code> para buscar URL/Favicon en Google.</li>
                    <li><strong>Botones:</strong> Guardar, Resetear (volver al original), Vaciar (eliminar marcador), Cancelar.</li>
                </ul>
            </li>
            <li><strong>Editar Etiqueta de Sección:</strong> Haz clic en uno de los botones laterales de sección (ej. <code>PdR,s</code>). Se abrirá un editor para cambiar su etiqueta (máx. 7 caracteres).</li>
            <li><strong>Reordenar Marcadores:</strong>
                <ul>
                    <li><strong>PC:</strong> Haz clic sobre un marcador, mantén pulsado y arrástralo a una nueva posición (incluso sobre un hueco vacío). Suelta para fijarlo.</li>
                    <li><strong>Táctil:</strong> Toca un marcador, mantén pulsado un instante hasta que se vea "semitransparente" (dragging), y arrástralo a la nueva posición. Levanta el dedo para fijarlo.</li>
                    <li><span class="note">El marcador se insertará en la nueva posición, desplazando los demás. Los cambios de orden se guardan automáticamente al soltar.</span></li>
                </ul>
            </li>
            <li><strong>Salir del Modo Edición:</strong> Pulsa de nuevo el botón de <strong>Personalización</strong> (amarillo). <strong class="warning">La página se recargará.</strong></li>
        </ul>

        <h3>3. Modo Asignación (Botón Cian):</h3>
        <div class="image-placeholder">[Imagen: Rejilla en modo asignación, con un botón lateral resaltado en cian y algunos marcadores resaltados también en cian]</div>
        <ul>
            <li>Este modo te permite decidir qué marcadores se ocultarán/mostrarán con cada botón lateral de sección (ej. <code>PdR,s</code>, <code>iAs</code>).</li>
            <li><strong>Seleccionar Botón Lateral:</strong> Primero, haz clic en el botón lateral (ej. <code>PdR,s</code>) que quieres configurar. Se resaltará en cian.</li>
            <li><strong>Asignar/Desasignar Marcadores:</strong> Ahora, haz clic en cualquier marcador de la rejilla.
                <ul>
                    <li>Si el marcador <em>no estaba</em> asignado a este botón, se asignará (se resaltará con un borde cian).</li>
                    <li>Si el marcador <em>ya estaba</em> asignado, se desasignará (perderá el borde cian y se atenuará).</li>
                    <li><strong class="warning">Importante:</strong> En este modo, hacer clic en un marcador <strong>NO</strong> abre su URL.</li>
                </ul>
            </li>
            <li><strong>Cambiar de Botón:</strong> Simplemente haz clic en otro botón lateral para empezar a asignar/desasignar sus marcadores.</li>
            <li><strong>Marcadores No Asignados:</strong> Los marcadores que no estén asignados a <em>ningún</em> botón lateral siempre serán visibles (a menos que el botón <strong>On/Off General</strong> esté en Off).</li>
            <li><strong>Salir del Modo Asignación:</strong> Pulsa de nuevo el botón de <strong>Personalización</strong> (cian). Los cambios se guardan automáticamente. <strong class="warning">La página se recargará.</strong></li>
        </ul>

        <h2>7. Configuración</h2>
        <p>Accede pulsando el botón de <strong>Configuración (Engranaje)</strong>. Se abrirá un modal con varias pestañas.</p>
        <div class="image-placeholder">[Imagen: Modal de configuración, mostrando quizás la pestaña Backup/Restore]</div>

        <h3>Pestaña Usuario: (Opcional)</h3>
        <ul>
            <li>Puedes introducir un "ID Usuario (Apodo)" y datos sobre tu Tesla (Modelo, Año, Provincia).</li>
            <li>La casilla "Permitir MDs" indica si das permiso al administrador para contactarte vía Twitter DM (si tu ID es tu usuario de Twitter).</li>
            <li><strong>Guardar Datos:</strong> Guarda esta información localmente e intenta sincronizarla con una <a href="https://docs.google.com/spreadsheets/d/1-DiwTDrxpUrfYpa_yahHHqeOMYK0ny-KPdoLrDU3uYw/edit?usp=sharing" target="_blank" rel="noopener noreferrer">hoja de cálculo compartida</a>. El ID de Usuario debe ser único. Si ya existe, no se guardará remotamente.</li>
            <li><strong>Resetear Reg.:</strong> Borra tus datos de usuario locales e intenta borrarlos también de la hoja de cálculo remota.</li>
        </ul>

        <h3>Pestaña Clave Acceso:</h3>
        <ul>
            <li>Permite establecer, cambiar o quitar una clave (PIN) de 4 cifras.</li>
            <li>Esta clave se solicita al cargar la página si está activa.</li>
            <li>Se guarda <strong>únicamente en tu navegador</strong>. Si borras los datos del navegador, se pierde.</li>
            <li><strong>Guardar Clave:</strong> Establece o cambia el PIN (debes introducirlo y confirmarlo).</li>
            <li><strong>Quitar Clave:</strong> Elimina el PIN guardado.</li>
            <li><span class="note">El botón del <strong>Candado</strong> (junto a Recargar) en la interfaz principal permite activar/desactivar la <em>solicitud</em> de este PIN al inicio, sin borrar el PIN en sí.</span></li>
        </ul>

        <h3>Pestaña Backup/Restore:</h3>
        <ul>
            <li><strong>Generar Backup:</strong> Crea un bloque de texto (JSON) que contiene tus recordatorios, personalización de la rejilla, ajustes de interfaz (modo oscuro, zoom, etc.), datos de usuario y estado del PIN. <strong class="warning">Debes copiar este texto y guardarlo en un lugar seguro.</strong></li>
            <li><strong>Restaurar Copia:</strong> Pega un texto de backup previamente guardado en el área designada y pulsa "Restaurar". La aplicación intentará restaurar los datos compatibles del backup, sobrescribiendo los actuales. <strong class="warning">Requiere recargar la página.</strong></li>
        </ul>

        <h3>Pestaña Borrar Datos:</h3>
        <ul>
            <li><strong>RESTAURAR EL GRID ORIGINAL:</strong> Elimina <strong>solo</strong> la personalización de los marcadores y la asignación a botones laterales, volviendo a la configuración por defecto de la rejilla. No afecta recordatorios ni otros ajustes. <strong class="warning">Requiere recargar la página.</strong></li>
            <li><strong>Borrar TODO:</strong> <strong class="warning">¡ACCIÓN IRREVERSIBLE!</strong> Elimina <strong>todos</strong> los datos de esta aplicación guardados en tu navegador (recordatorios, personalización, ajustes, PIN, datos de usuario locales). Úsalo con precaución y asegúrate de tener un backup si quieres conservar algo. <strong class="warning">Requiere recargar la página.</strong></li>
        </ul>

        <p><strong>Cerrar:</strong> Cierra el modal de configuración.</p>

        <h2>8. Solución de Problemas / Consejos</h2>
        <ul>
            <li><strong>La página no carga bien / Comportamiento extraño:</strong> Intenta recargar la página (botón <strong>Recargar</strong>). Si persiste, prueba a borrar la caché del navegador para esta página. Como último recurso, usa la opción "Borrar TODO" en Configuración (<strong class="warning">¡ten backup!</strong>).</li>
            <li><strong>He perdido mi personalización:</strong> ¿Borraste los datos del navegador? ¿Usaste "Borrar TODO"? La única forma de recuperarla es usando un backup que hubieras guardado previamente.</li>
            <li><strong>El reconocimiento de voz no funciona:</strong> Asegúrate de que tu navegador lo soporta y que has dado permiso para usar el micrófono.</li>
            <li><strong>Los recordatorios no me notifican:</strong> Comprueba que los permisos de notificación del navegador están habilitados para esta página. Asegúrate de que la fecha/hora/repetición del recordatorio son correctas.</li>
        </ul>
    </div>
</body>
</html>